<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Tracking System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background: #f5f7fa;
            height: 100vh;
            overflow: hidden;
        }

        /* Login Page (Hidden after login) */
        #loginPage {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .login-container {
            width: 100%;
            max-width: 400px;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .login-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .login-header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }

        .login-header h1 {
            font-size: 2.2rem;
            font-weight: 600;
        }

        .login-form {
            padding: 40px 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .input-with-icon {
            position: relative;
        }

        .input-with-icon i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #a0aec0;
        }

        input {
            width: 100%;
            padding: 15px 15px 15px 45px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            background: #f8fafc;
        }

        input:focus {
            outline: none;
            border-color: #6a11cb;
            background: white;
            box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.1);
        }

        .password-container {
            position: relative;
        }

        .toggle-password {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #a0aec0;
            cursor: pointer;
            font-size: 18px;
        }

        .remember-forgot {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .remember {
            display: flex;
            align-items: center;
        }

        .remember input {
            width: auto;
            margin-right: 8px;
        }

        .forgot {
            color: #6a11cb;
            text-decoration: none;
            font-weight: 500;
        }

        .forgot:hover {
            text-decoration: underline;
        }

        .btn-login {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 5px;
        }

        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(106, 17, 203, 0.3);
        }

        .btn-login:active {
            transform: translateY(0);
        }

        .message {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-size: 14px;
            display: none;
        }

        .message.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }

        .message.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        /* ===== AFTER LOGIN: VEHICLE LIST PAGE ===== */
        #vehicleListPage, #mapPage {
            display: none;
            height: 100vh;
        }

        /* Header with Burger Menu */
        .header {
            background: white;
            padding: 0 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            height: 70px;
        }

        .burger-menu {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #4a5568;
            cursor: pointer;
            margin-right: 20px;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .burger-menu:hover {
            background: #f7fafc;
            color: #6a11cb;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
        }

        .logo i {
            font-size: 1.8rem;
            color: #6a11cb;
        }

        .logo h1 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2d3748;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .btn-logout {
            background: #f56565;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-logout:hover {
            background: #c53030;
        }

        /* Sidebar Navigation */
        .sidebar {
            position: fixed;
            top: 70px;
            left: -300px;
            width: 300px;
            height: calc(100vh - 70px);
            background: white;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            transition: left 0.3s ease;
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }

        .sidebar.active {
            left: 0;
        }

        .sidebar-section {
            margin-bottom: 30px;
        }

        .sidebar-section h3 {
            color: #4a5568;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            color: #718096;
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 5px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .nav-item:hover {
            background: #f7fafc;
            color: #6a11cb;
        }

        .nav-item.active {
            background: linear-gradient(135deg, #6a11cb15 0%, #2575fc15 100%);
            color: #6a11cb;
            border-left: 3px solid #6a11cb;
        }

        .nav-item i {
            font-size: 1.1rem;
            width: 20px;
        }

        /* Vehicle List Container */
        .vehicle-list-container {
            padding: 30px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        .page-title {
            color: #2d3748;
            font-size: 2rem;
            margin-bottom: 30px;
            font-weight: 600;
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .stat-1 .stat-icon { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .stat-2 .stat-icon { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .stat-3 .stat-icon { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #718096;
            font-size: 0.9rem;
        }

        /* Vehicle Grid */
        .vehicle-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .vehicle-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .vehicle-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-color: #6a11cb;
        }

        .vehicle-header {
            padding: 20px;
            background: #f7fafc;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .vehicle-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .vehicle-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2d3748;
        }

        .vehicle-body {
            padding: 20px;
        }

        .vehicle-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .info-item label {
            display: block;
            color: #718096;
            font-size: 0.8rem;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-item .value {
            color: #2d3748;
            font-weight: 600;
        }

        .vehicle-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .status-moving { background: #c6f6d5; color: #22543d; }
        .status-stopped { background: #fed7d7; color: #742a2a; }
        .status-idle { background: #feebc8; color: #744210; }
        .status-offline { background: #e2e8f0; color: #4a5568; }

        .track-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .track-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(106, 17, 203, 0.3);
        }

        /* ===== MAP PAGE ===== */
        #mapPage {
            display: none;
            flex-direction: column;
        }

        .map-header {
            display: flex;
            align-items: center;
            padding: 0 20px;
            background: white;
            height: 70px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .back-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #4a5568;
            cursor: pointer;
            margin-right: 20px;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: #f7fafc;
            color: #6a11cb;
        }

        .vehicle-details {
            flex: 1;
        }

        .vehicle-details h2 {
            color: #2d3748;
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .vehicle-details p {
            color: #718096;
            font-size: 0.9rem;
        }

        /* Map Container */
        .map-container {
            flex: 1;
            background: white;
            position: relative;
        }

        #vehicleMap {
            width: 100%;
            height: 100%;
        }

        .map-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .map-btn {
            background: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            color: #4a5568;
            transition: all 0.3s;
        }

        .map-btn:hover {
            background: #f7fafc;
            color: #6a11cb;
        }

        .map-sidebar {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 300px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            padding: 20px;
        }

        .map-vehicle-info h3 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }

        .map-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .map-info-item label {
            display: block;
            color: #718096;
            font-size: 0.8rem;
            margin-bottom: 5px;
            text-transform: uppercase;
        }

        .map-info-item .value {
            color: #2d3748;
            font-weight: 600;
        }

        .vehicle-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .action-btn {
            padding: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .action-btn.primary {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
        }

        .action-btn.secondary {
            background: #edf2f7;
            color: #4a5568;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        /* Overlay for sidebar */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }

        .sidebar-overlay.active {
            display: block;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .vehicle-grid {
                grid-template-columns: 1fr;
            }
            
            .map-sidebar {
                width: calc(100% - 40px);
            }
        }
    </style>
</head>
<body>
    <!-- LOGIN PAGE -->
    <div id="loginPage">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <h1>Vehicle Tracking System</h1>
                </div>
                
                <div class="login-form">
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="username">Username</label>
                            <div class="input-with-icon">
                                <i class="fas fa-user"></i>
                                <input type="text" id="username" placeholder="Enter username" required autofocus>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="password">Password</label>
                            <div class="input-with-icon password-container">
                                <i class="fas fa-lock"></i>
                                <input type="password" id="password" placeholder="Enter password" required>
                                <button type="button" class="toggle-password" id="togglePassword">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="remember-forgot">
                            <div class="remember">
                                <input type="checkbox" id="remember">
                                <label for="remember">Remember me</label>
                            </div>
                            <a href="#" class="forgot">Forgot password?</a>
                        </div>
                        
                        <button type="submit" class="btn-login">Sign In</button>
                        
                        <div id="loginMessage" class="message"></div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- USER DASHBOARD PAGE -->
    <div id="dashboardPage" style="display: none;">
        <!-- Header -->
        <div class="header">
            <button class="burger-menu" id="burgerMenu">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="logo">
                <i class="fas fa-car"></i>
                <h1>Vehicle Tracker</h1>
            </div>
            
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">A</div>
                <button class="btn-logout" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>

        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-section">
                <h3>Navigation</h3>
                <div class="nav-item active">
                    <i class="fas fa-car"></i>
                    <span>Vehicle List</span>
                </div>
                <div class="nav-item">
                    <i class="fas fa-history"></i>
                    <span>History</span>
                </div>
                <div class="nav-item">
                    <i class="fas fa-chart-bar"></i>
                    <span>Reports</span>
                </div>
                <div class="nav-item">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </div>
            </div>

            <div class="sidebar-section">
                <h3>Quick Stats</h3>
                <div style="padding: 10px 15px;">
                    <div style="display: flex; align-items: center; margin-bottom: 10px;">
                        <div style="width: 10px; height: 10px; background: #38a169; border-radius: 50%; margin-right: 10px;"></div>
                        <span style="font-size: 0.9rem;">Moving: <strong>8</strong></span>
                    </div>
                    <div style="display: flex; align-items: center; margin-bottom: 10px;">
                        <div style="width: 10px; height: 10px; background: #e53e3e; border-radius: 50%; margin-right: 10px;"></div>
                        <span style="font-size: 0.9rem;">Stopped: <strong>4</strong></span>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <div style="width: 10px; height: 10px; background: #a0aec0; border-radius: 50%; margin-right: 10px;"></div>
                        <span style="font-size: 0.9rem;">Offline: <strong>2</strong></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="vehicle-list-container">
            <h1 class="page-title">Fleet Vehicles</h1>
            
            <div class="stats-cards">
                <div class="stat-card stat-1">
                    <div class="stat-header">
                        <div>
                            <div class="stat-value">14</div>
                            <div class="stat-label">Total Vehicles</div>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-truck"></i>
                        </div>
                    </div>
                </div>

                <div class="stat-card stat-2">
                    <div class="stat-header">
                        <div>
                            <div class="stat-value">8</div>
                            <div class="stat-label">Active Now</div>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-play-circle"></i>
                        </div>
                    </div>
                </div>

                <div class="stat-card stat-3">
                    <div class="stat-header">
                        <div>
                            <div class="stat-value">94%</div>
                            <div class="stat-label">Online</div>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-wifi"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vehicle List -->
            <div class="vehicle-grid" id="vehicleGrid">
                <!-- Vehicles will be added here by JavaScript -->
            </div>
        </div>
    </div>

    <!-- MAP PAGE -->
    <div id="mapPage" style="display: none;">
        <!-- Map Header -->
        <div class="map-header">
            <button class="back-btn" id="backBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            
            <div class="vehicle-details" id="mapVehicleDetails">
                <h2>Vehicle KA-01-AB-1234</h2>
                <p>Live Tracking • Last updated: 2 min ago</p>
            </div>
            
            <div class="user-info">
                <div class="user-avatar">A</div>
                <button class="btn-logout" id="mapLogoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>

        <!-- Map Container -->
        <div class="map-container">
            <div id="vehicleMap"></div>
            
            <!-- Map Controls -->
            <div class="map-controls">
                <button class="map-btn" id="zoomIn">
                    <i class="fas fa-plus"></i>
                </button>
                <button class="map-btn" id="zoomOut">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="map-btn" id="locateVehicle">
                    <i class="fas fa-crosshairs"></i>
                </button>
                <button class="map-btn" id="fullScreen">
                    <i class="fas fa-expand"></i>
                </button>
            </div>

            <!-- Vehicle Info Sidebar -->
            <div class="map-sidebar">
                <div class="map-vehicle-info">
                    <h3 id="mapVehicleNumber">KA-01-AB-1234</h3>
                    
                    <div class="map-info-grid">
                        <div class="map-info-item">
                            <label>Status</label>
                            <div class="value">
                                <span class="vehicle-status status-moving" id="mapVehicleStatus">
                                    <i class="fas fa-play"></i> Moving
                                </span>
                            </div>
                        </div>
                        <div class="map-info-item">
                            <label>Speed</label>
                            <div class="value" id="mapVehicleSpeed">65 km/h</div>
                        </div>
                        <div class="map-info-item">
                            <label>Driver</label>
                            <div class="value" id="mapVehicleDriver">John Smith</div>
                        </div>
                        <div class="map-info-item">
                            <label>Location</label>
                            <div class="value" id="mapVehicleLocation">Downtown Area</div>
                        </div>
                    </div>
                    
                    <div class="vehicle-actions">
                        <button class="action-btn primary" id="callDriver">
                            <i class="fas fa-phone"></i> Call
                        </button>
                        <button class="action-btn secondary" id="viewHistory">
                            <i class="fas fa-history"></i> History
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // ========== CONFIGURATION ==========
        const userAccounts = {
            "admin": {
                password: "Password123!",
                role: "Administrator",
                avatarText: "A"
            },
            "dispatcher": {
                password: "Dispatch@2024",
                role: "Dispatcher",
                avatarText: "D"
            },
            "manager": {
                password: "Manager@2024",
                role: "Manager",
                avatarText: "M"
            }
        };

        // Vehicle data with real locations
        const vehicles = [
            {
                id: "VH-001",
                number: "KA-01-AB-1234",
                driver: "Rajesh Kumar",
                status: "moving",
                speed: "65 km/h",
                location: "MG Road, Bangalore",
                coordinates: [12.9716, 77.5946], // Bangalore
                lastUpdate: "2 min ago",
                fuel: "78%",
                temperature: "24°C"
            },
            {
                id: "VH-002",
                number: "MH-02-CD-5678",
                driver: "Suresh Patel",
                status: "stopped",
                speed: "0 km/h",
                location: "Nariman Point, Mumbai",
                coordinates: [19.0760, 72.8777], // Mumbai
                lastUpdate: "5 min ago",
                fuel: "45%",
                temperature: "28°C"
            },
            {
                id: "VH-003",
                number: "DL-03-EF-9012",
                driver: "Amit Sharma",
                status: "idle",
                speed: "0 km/h",
                location: "Connaught Place, Delhi",
                coordinates: [28.6139, 77.2090], // Delhi
                lastUpdate: "10 min ago",
                fuel: "92%",
                temperature: "22°C"
            },
            {
                id: "VH-004",
                number: "TN-04-GH-3456",
                driver: "Karthik Reddy",
                status: "moving",
                speed: "45 km/h",
                location: "Marina Beach, Chennai",
                coordinates: [13.0827, 80.2707], // Chennai
                lastUpdate: "1 min ago",
                fuel: "34%",
                temperature: "30°C"
            },
            {
                id: "VH-005",
                number: "GJ-05-IJ-7890",
                driver: "Vikram Joshi",
                status: "offline",
                speed: "N/A",
                location: "Sabarmati, Ahmedabad",
                coordinates: [23.0225, 72.5714], // Ahmedabad
                lastUpdate: "1 hour ago",
                fuel: "15%",
                temperature: "N/A"
            },
            {
                id: "VH-006",
                number: "WB-06-KL-2345",
                driver: "Sourav Das",
                status: "moving",
                speed: "55 km/h",
                location: "Howrah Bridge, Kolkata",
                coordinates: [22.5726, 88.3639], // Kolkata
                lastUpdate: "3 min ago",
                fuel: "67%",
                temperature: "26°C"
            }
        ];

        // ========== DOM ELEMENTS ==========
        const loginPage = document.getElementById('loginPage');
        const dashboardPage = document.getElementById('dashboardPage');
        const mapPage = document.getElementById('mapPage');
        const vehicleGrid = document.getElementById('vehicleGrid');
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebarOverlay');
        const burgerMenu = document.getElementById('burgerMenu');
        const backBtn = document.getElementById('backBtn');
        const logoutBtns = document.querySelectorAll('.btn-logout');
        
        // Map elements
        let vehicleMap = null;
        let currentVehicleMarker = null;
        let currentVehicle = null;

        // ========== LOGIN FUNCTIONS ==========
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const messageEl = document.getElementById('loginMessage');
            
            messageEl.className = 'message';
            messageEl.textContent = '';
            
            if (!username || !password) {
                showMessage('Please fill in all fields', 'error', 'loginMessage');
                return;
            }
            
            if (userAccounts.hasOwnProperty(username.toLowerCase())) {
                const user = userAccounts[username.toLowerCase()];
                
                if (password === user.password) {
                    showMessage('Login successful! Redirecting...', 'success', 'loginMessage');
                    
                    // Update user info
                    document.getElementById('userAvatar').textContent = user.avatarText;
                    
                    // Show dashboard page after delay
                    setTimeout(() => {
                        hideAllPages();
                        dashboardPage.style.display = 'block';
                        loadVehicleList();
                    }, 1500);
                    
                } else {
                    showMessage('Incorrect password', 'error', 'loginMessage');
                }
            } else {
                showMessage('Username not found', 'error', 'loginMessage');
            }
        });

        // ========== SIGNUP FUNCTIONS ==========
        document.getElementById('signupForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('signupUsername').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;
            const agreeTerms = document.getElementById('agreeTerms').checked;
            const messageEl = document.getElementById('signupMessage');
            
            messageEl.className = 'message';
            messageEl.textContent = '';
            
            // Validation
            if (!username || !email || !password || !confirmPassword) {
                showMessage('Please fill in all fields', 'error', 'signupMessage');
                return;
            }
            
            if (password !== confirmPassword) {
                showMessage('Passwords do not match', 'error', 'signupMessage');
                return;
            }
            
            if (password.length < 6) {
                showMessage('Password must be at least 6 characters', 'error', 'signupMessage');
                return;
            }
            
            if (!agreeTerms) {
                showMessage('Please agree to Terms & Conditions', 'error', 'signupMessage');
                return;
            }
            
            if (userAccounts.hasOwnProperty(username.toLowerCase())) {
                showMessage('Username already exists', 'error', 'signupMessage');
                return;
            }
            
            // Create new user (in real app, this would go to backend)
            const avatarText = username.charAt(0).toUpperCase();
            userAccounts[username.toLowerCase()] = {
                password: password,
                email: email,
                role: "User",
                avatarText: avatarText
            };
            
            showMessage('Account created successfully! Redirecting to login...', 'success', 'signupMessage');
            
            setTimeout(() => {
                // Reset signup form and go back to login
                document.getElementById('signupForm').reset();
                hideAllPages();
                loginPage.style.display = 'flex';
                document.getElementById('username').value = username;
                document.getElementById('password').focus();
            }, 1500);
        });

        // ========== PAGE NAVIGATION ==========
        document.getElementById('goToSignup').addEventListener('click', function(e) {
            e.preventDefault();
            hideAllPages();
            signupPage.style.display = 'flex';
            document.getElementById('signupUsername').focus();
        });

        document.getElementById('goToLogin').addEventListener('click', function(e) {
            e.preventDefault();
            hideAllPages();
            loginPage.style.display = 'flex';
            document.getElementById('username').focus();
        });

        function hideAllPages() {
            loginPage.style.display = 'none';
            signupPage.style.display = 'none';
            dashboardPage.style.display = 'none';
            mapPage.style.display = 'none';
        }

        // ========== VEHICLE LIST FUNCTIONS ==========
        function loadVehicleList() {
            vehicleGrid.innerHTML = '';
            
            vehicles.forEach(vehicle => {
                const vehicleCard = document.createElement('div');
                vehicleCard.className = 'vehicle-card';
                vehicleCard.dataset.vehicleId = vehicle.id;
                
                vehicleCard.innerHTML = `
                    <div class="vehicle-header">
                        <div class="vehicle-icon">
                            <i class="fas fa-truck"></i>
                        </div>
                        <div class="vehicle-number">${vehicle.number}</div>
                    </div>
                    <div class="vehicle-body">
                        <div class="vehicle-info">
                            <div class="info-item">
                                <label>Driver</label>
                                <div class="value">${vehicle.driver}</div>
                            </div>
                            <div class="info-item">
                                <label>Status</label>
                                <div class="value">
                                    <span class="vehicle-status status-${vehicle.status}">
                                        <i class="fas fa-${getStatusIcon(vehicle.status)}"></i> 
                                        ${vehicle.status.charAt(0).toUpperCase() + vehicle.status.slice(1)}
                                    </span>
                                </div>
                            </div>
                            <div class="info-item">
                                <label>Speed</label>
                                <div class="value">${vehicle.speed}</div>
                            </div>
                            <div class="info-item">
                                <label>Location</label>
                                <div class="value">${vehicle.location}</div>
                            </div>
                        </div>
                        <button class="track-btn" onclick="showVehicleOnMap('${vehicle.id}')">
                            <i class="fas fa-map-marker-alt"></i> Track on Map
                        </button>
                    </div>
                `;
                
                vehicleGrid.appendChild(vehicleCard);
            });
        }

        function getStatusIcon(status) {
            switch(status) {
                case 'moving': return 'play';
                case 'stopped': return 'pause';
                case 'idle': return 'clock';
                default: return 'power-off';
            }
        }

        // ========== MAP FUNCTIONS ==========
        function showVehicleOnMap(vehicleId) {
            currentVehicle = vehicles.find(v => v.id === vehicleId);
            
            if (!currentVehicle) return;
            
            // Switch to map page
            hideAllPages();
            mapPage.style.display = 'flex';
            
            // Update map page header
            document.getElementById('mapVehicleDetails').innerHTML = `
                <h2>Vehicle ${currentVehicle.number}</h2>
                <p>Live Tracking • Last updated: ${currentVehicle.lastUpdate}</p>
            `;
            
            // Update sidebar info
            document.getElementById('mapVehicleNumber').textContent = currentVehicle.number;
            document.getElementById('mapVehicleStatus').innerHTML = `
                <i class="fas fa-${getStatusIcon(currentVehicle.status)}"></i> 
                ${currentVehicle.status.charAt(0).toUpperCase() + currentVehicle.status.slice(1)}
            `;
            document.getElementById('mapVehicleStatus').className = `vehicle-status status-${currentVehicle.status}`;
            document.getElementById('mapVehicleSpeed').textContent = currentVehicle.speed;
            document.getElementById('mapVehicleDriver').textContent = currentVehicle.driver;
            document.getElementById('mapVehicleLocation').textContent = currentVehicle.location;
            
            // Initialize map if not already initialized
            if (!vehicleMap) {
                initMap();
            } else {
                // Clear previous marker
                if (currentVehicleMarker) {
                    vehicleMap.removeLayer(currentVehicleMarker);
                }
                
                // Add new marker
                addVehicleMarker(currentVehicle);
                
                // Center map on vehicle
                vehicleMap.setView(currentVehicle.coordinates, 13);
            }
        }

        function initMap() {
            // Initialize map centered on India
            vehicleMap = L.map('vehicleMap').setView([20.5937, 78.9629], 5);
            
            // Add tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(vehicleMap);
            
            // Add vehicle marker
            addVehicleMarker(currentVehicle);
            
            // Center on vehicle
            vehicleMap.setView(currentVehicle.coordinates, 13);
            
            // Add map controls
            setupMapControls();
        }

        function addVehicleMarker(vehicle) {
            // Create custom icon based on status
            const icon = L.divIcon({
                html: `<div style="
                    background: ${getStatusColor(vehicle.status)};
                    width: 30px;
                    height: 30px;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 14px;
                    border: 3px solid white;
                    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
                ">
                    <i class="fas fa-truck"></i>
                </div>`,
                className: 'vehicle-marker',
                iconSize: [30, 30],
                iconAnchor: [15, 15]
            });
            
            currentVehicleMarker = L.marker(vehicle.coordinates, { icon: icon })
                .addTo(vehicleMap)
                .bindPopup(`
                    <div style="padding: 10px;">
                        <h4 style="margin: 0 0 5px 0;">${vehicle.number}</h4>
                        <p style="margin: 0 0 5px 0;">Driver: ${vehicle.driver}</p>
                        <p style="margin: 0 0 5px 0;">Status: ${vehicle.status}</p>
                        <p style="margin: 0 0 5px 0;">Speed: ${vehicle.speed}</p>
                        <p style="margin: 0 0 5px 0;">Location: ${vehicle.location}</p>
                    </div>
                `);
        }

        function getStatusColor(status) {
            switch(status) {
                case 'moving': return '#38a169';
                case 'stopped': return '#e53e3e';
                case 'idle': return '#d69e2e';
                default: return '#a0aec0';
            }
        }

        function setupMapControls() {
            document.getElementById('zoomIn').addEventListener('click', () => {
                vehicleMap.zoomIn();
            });
            
            document.getElementById('zoomOut').addEventListener('click', () => {
                vehicleMap.zoomOut();
            });
            
            document.getElementById('locateVehicle').addEventListener('click', () => {
                if (currentVehicle) {
                    vehicleMap.setView(currentVehicle.coordinates, 15);
                }
            });
            
            document.getElementById('fullScreen').addEventListener('click', () => {
                const elem = document.getElementById('vehicleMap');
                if (!document.fullscreenElement) {
                    elem.requestFullscreen();
                } else {
                    document.exitFullscreen();
                }
            });
        }

        // ========== UI CONTROLS ==========
        // Toggle sidebar
        burgerMenu.addEventListener('click', () => {
            sidebar.classList.add('active');
            sidebarOverlay.classList.add('active');
        });

        // Close sidebar when clicking overlay
        sidebarOverlay.addEventListener('click', () => {
            sidebar.classList.remove('active');
            sidebarOverlay.classList.remove('active');
        });

        // Back button from map to dashboard
        backBtn.addEventListener('click', () => {
            hideAllPages();
            dashboardPage.style.display = 'block';
        });

        // Logout buttons
        logoutBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                hideAllPages();
                loginPage.style.display = 'flex';
                
                // Reset form
                document.getElementById('loginForm').reset();
                document.getElementById('username').focus();
            });
        });

        // Toggle password visibility
        document.getElementById('togglePassword').addEventListener('click', function() {
            togglePasswordVisibility('password');
        });

        function togglePasswordVisibility(inputId) {
            const passwordInput = document.getElementById(inputId);
            const type = passwordInput.type === 'password' ? 'text' : 'password';
            passwordInput.type = type;
            
            const eyeIcon = event.target.closest('button').querySelector('i');
            eyeIcon.className = type === 'text' ? 'fas fa-eye-slash' : 'fas fa-eye';
        }

        // Forgot password
        document.querySelector('.forgot').addEventListener('click', function(e) {
            e.preventDefault();
            showMessage('Password reset link would be sent to registered email', 'success', 'loginMessage');
        });

        // ========== HELPER FUNCTIONS ==========
        function showMessage(message, type, elementId = 'loginMessage') {
            const messageEl = document.getElementById(elementId);
            messageEl.textContent = message;
            messageEl.className = `message ${type}`;
            
            setTimeout(() => {
                messageEl.className = 'message';
                messageEl.textContent = '';
            }, 5000);
        }

        // ========== INITIALIZE ==========
        // Clear authentication on page refresh
        window.addEventListener('beforeunload', () => {
            localStorage.removeItem('authToken');
            localStorage.removeItem('currentUser');
        });

        // Check for remembered user
        window.addEventListener('DOMContentLoaded', () => {
            // Always show login page on refresh
            hideAllPages();
            loginPage.style.display = 'flex';
            
            const rememberedUser = localStorage.getItem('rememberedUser');
            if (rememberedUser) {
                document.getElementById('username').value = rememberedUser;
                document.getElementById('remember').checked = true;
                document.getElementById('password').focus();
            } else {
                document.getElementById('username').focus();
            }
        });

        // Remember me functionality
        document.getElementById('remember').addEventListener('change', function() {
            const username = document.getElementById('username').value;
            if (this.checked && username) {
                localStorage.setItem('rememberedUser', username);
            } else {
                localStorage.removeItem('rememberedUser');
            }
        });

        // Map buttons functionality
        document.getElementById('callDriver').addEventListener('click', () => {
            if (currentVehicle) {
                alert(`Calling driver: ${currentVehicle.driver}`);
            }
        });

        document.getElementById('viewHistory').addEventListener('click', () => {
            if (currentVehicle) {
                alert(`Showing history for vehicle: ${currentVehicle.number}`);
            }
        });
    </script>
</body>
</html>
